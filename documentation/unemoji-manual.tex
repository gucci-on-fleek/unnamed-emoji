% unnamed-emoji
% https://github.com/gucci-on-fleek/unnamed-emoji
% SPDX-License-Identifier: MPL-2.0+ OR CC-BY-SA-4.0+
% SPDX-FileCopyrightText: 2023 Max Chernoff

\doifnot{\contextmark}{LMTX}{
    \errhelp{LMTX/MkXL is required to compile this file.}
    \errmessage{Fatal error, exiting.}
}

% Get from either of
%     <texmf-dist/source/luatex/lua-widow-control/lwc-manual.mkxl>
%     <https://raw.githubusercontent.com/gucci-on-fleek/lua-widow-control/master/docs/manual/lwc-manual.mkxl>
\environment lwc-manual

\environment unemoji-manual

\usemodule[scite]

% Abbreviations
\def\unemoji/{\sans{unnamed-emoji}}
\def\Unemoji/{\sans{Unnamed-emoji}}
\define\OpTeX{Op\kern-.05em\TeX}
\useURL[projecturl][https://github.com/gucci-on-fleek/unnamed-emoji]
\let\q=\quotation


\startdocument[
    title=unnamed-emoji,
    author=Max Chernoff,
    version=0.0.4, %%version
    github=https://github.com/gucci-on-fleek/unnamed-emoji,
]

\Unemoji/ is an experimental emoji package for \LaTeX{}, \ConTeXt{},
Plain~\TeX{}, and OpTeX. It natively supports \pdfTeX{} and \LuaTeX{}, and can
support \XeTeX{} and any other \TeX{} engine using \type{dvipdfmx} with a
patched version of \type{dvipdfmx}.

\subject{Contents}
\placecontent[criterium=all]

\section{Loading}

\Unemoji/ has support for \LaTeX{}, \ConTeXt{}, Plain~\TeX{}, and \OpTeX{}.
Loading the package is as follows:

\subsection{\LaTeX{}}
\startlatex[prebuffer=, postbuffer=]
\documentclass{article}

\usepackage{unnamed-emoji}

\begin{document}
    \emoji{duck}
\end{document}
\stoplatex

\subsection{\ConTeXt{}}
\startlatex[engine=context,prebuffer=,postbuffer=]
% LMTX Only!
\usemodule[unnamed-emoji]

\startTEXpage[offset=1pt]
    \emoji{duck}
\stopTEXpage
\stoplatex

\subsection{Plain \TeX{}}
\startbuffer[pre]
\pdfhorigin=0in
\pdfvorigin=0in
\pdfpagewidth=1em
\pdfpageheight=\baselineskip
\parindent=0pt
\stopbuffer

\startlatex[engine=pdftex,prebuffer=pre]
\input unnamed-emoji

\emoji{duck}
\bye
\stoplatex

\subsection{\OpTeX{}}
\startbuffer[pre]
\fontfam[LMfonts]
\margins/1 (1,1) (0,0,0,0)em
\parindent=0pt
\stopbuffer

\startlatex[engine=optex,prebuffer=pre]
\load[unnamed-emoji]

\emoji{duck}
\bye
\stoplatex

\section{Input Formats}

There are four different ways to select any given emoji.

\subsection{Name}

First, you can select an emoji by giving its officially-assigned Unicode name:

\startlatex[]
\emoji{duck}
\stoplatex

\subsection{Hexadecimal}

You can also select an emoji by its Unicode codepoint in hexadecimal:

\startlatex[]
\emoji{1f986}
\stoplatex

\subsection{Decimal}

Or in decimal (base-10):

\startlatex[]
\emoji{129414}
\stoplatex

\subsection{Unicode}

Finally, if you are using Lua\TeX{}, you can enter the Unicode character
directly:

\startlatex[]
\emoji{ðŸ¦†}  % LuaTeX Only!
\stoplatex

\section{Font Selection}

\Unemoji/ allows you to select from a variety of emoji fonts. Below follows a
demonstration of how to select the font as well as a sample glyph from each
currently-supported font.

\subsection{\LaTeX{}/\\\ConTeXt{}/\\\OpTeX{}\phantom{/}}
\startlatex[figureparams={width=0.29\textwidth}]
\begin{tabular}{r@{: }l}
    \texttt{noto-emoji} &
    \emoji[noto-emoji]{1f638} \\
    %
    \texttt{twemoji} &
    \emoji[twemoji]{1f638} \\
    %
    \texttt{fxemoji} &
    \emoji[fxemoji]{1f638} \\
    %
    \texttt{openmoji} &
    \emoji[openmoji]{1f638} \\
    %
    \texttt{emojione} &
    \emoji[emojione]{1f638} \\
\end{tabular}
\stoplatex

\subsection{Plain \TeX{}}
\startbuffer[pre]
\pdfhorigin=0in
\pdfvorigin=0in
\pdfpagewidth=1.2in
\pdfpageheight=6\baselineskip
\parindent=0pt
\input unnamed-emoji
\stopbuffer

\startbuffer[post]
\bye
\stopbuffer

\startlatex[
    engine=pdftex,
    prebuffer=pre,
    postbuffer=post,
    figureparams={width=0.29\textwidth}
]
\halign{\hfil\tt#\unskip:&#\hfil\cr
    noto-emoji &
    \def\emojifont{noto-emoji}
    \emoji{1f638} \cr
    %
    twemoji &
    \def\emojifont{twemoji}
    \emoji{1f638} \cr
    %
    fxemoji &
    \def\emojifont{fxemoji}
    \emoji{1f638} \cr
    %
    openmoji &
    \def\emojifont{openmoji}
    \emoji{1f638} \cr
    %
    emojione &
    \def\emojifont{emojione}
    \emoji{1f638} \cr
}
\stoplatex

\section{Composed Emoji}

Many emoji are composed of multiple Unicode codepoints. \Unemoji/ supports
these, although the input format is (currently) quite cumbersome.

\subsection{Name}

One option is to type the names of all components of the emoji, separated by
spaces. For this option, any \acronym{ZWJ} characters are omitted.

\startlatex[]
\emoji[twemoji]
  {regional indicator symbol letter c
   regional indicator symbol letter a}
\stoplatex

\subsection{Hexadecimal}

The other option is to type the hexadecimal codepoints of the emoji's
components, separated by hyphens. For this option, any \acronym{ZWJ} characters
\emph{must} be included.

\startlatex[]
\emoji[twemoji]{1f1e8-1f1e6}
\stoplatex

\section{Available Characters}

To view the full list of characters, fonts, and names available with \unemoji/,
please consult the font specimens (links:
\goto{Local}[unnamed-emoji-specimens::],
\acronym{CTAN} (not yet\dots),
\goto{GitHub}[url(https://github.com/gucci-on-fleek/unnamed-emoji/releases/latest/download/unnamed-emoji-specimens.pdf)]).

\section{Licence}
\setupinteraction[style=\tf]

Most files should list their licence near the top. In general, the code is
licensed under the \goto{{\em Mozilla Public License}, version
2.0}[url(https://www.mozilla.org/en-US/MPL/2.0/)] or greater. The documentation
is additionally licensed under \goto{\acronym{CC-BY-SA}, version
4.0}[url(https://creativecommons.org/licenses/by-sa/4.0/legalcode)] or greater.

\subsection{Noto Emoji}

\type{noto-emoji.pdf} (\q{Noto Emoji}) was created from the \type{svg/} folder
of
\goto{\tt googlefonts/noto-emoji@934a5706}[url(https://github.com/googlefonts/noto-emoji/tree/934a5706)]
and is licensed under the
\goto{{\em Apache License}, version 2.0}[url(https://github.com/googlefonts/noto-emoji/blob/934a5706/LICENSE)].

\subsection{Tw\-emoji}

\type{twemoji.pdf} (\q{Twitter Emoji}) was created from the \type{assets/svg/}
folder of
\goto{\tt twitter/twemoji@d94f4cf7}[url(https://github.com/twitter/twemoji/tree/d94f4cf7)]
and is licensed under
\goto{\acronym{CC-BY}~4.0}[url(https://github.com/twitter/twemoji/blob/d94f4cf7/LICENSE-GRAPHICS)].

\subsection{Fx\-Emoji}

\type{fxemoji.pdf} (\q{FxEmojis}) was created from the \type{svgs/FirefoxEmoji/}
folder of
\goto{\tt mozilla/fxemoji@270af343}[url(https://github.com/mozilla/fxemoji/tree/270af343)]
and is licensed under
\goto{\acronym{CC-BY}~4.0}[url(https://github.com/mozilla/fxemoji/blob/270af343/LICENSE.md)].

\subsection{Open\-Moji}

\type{openmoji.pdf} (\q{OpenMoji}) was created from the \type{color/svg/} folder
of
\goto{\tt hfg-gmuend/openmoji@d6d0daad}[url(https://github.com/hfg-gmuend/openmoji/tree/d6d0daad)]
and is licensed under
\goto{\acronym{CC-BY-SA}~4.0}[url(https://github.com/hfg-gmuend/openmoji/blob/d6d0daad/LICENSE.txt)].

\subsection{Emoji\-One}

\type{emojione.pdf} (\q{EmojiOne}) was created from the \type{assets/svg/}
folder of
\goto{\tt joypixels/emojione@v2.2.7}[url(https://github.com/joypixels/emojione/tree/v2.2.7)]
and is licensed under
\goto{\acronym{CC-BY}~4.0}[url(https://github.com/joypixels/emojione/blob/v2.2.7/LICENSE.md)].

\page
\setuplayout[
    width=middle,
    backspace=1in,
    height=9.25in,
]
\section[sec:implementation]{Implementation}

From here and until the end of this manual is the raw source code of \unemoji/.
This is primarily of interest to developers; most users need not read further.

If want to offer any improvements to the code below, please open an issue or a
\acronym{PR} on \goto{GitHub}[url(projecturl)].

\setupbodyfont[10pt]
\setuphead[subsection][
    alternative=normal,
    style=\ssitb,
    after={\blank[disable, penalty:10000]},
    page=yes,
    continue=yes,
]

\subsection{svg-to-pdf.cld}
\typeLUAfile{../source/svg-to-pdf.cld}

\subsection{unnamed-emoji.sty}
\typeTEXfile{../source/unnamed-emoji.sty}

\subsection{unnamed-emoji.tex}
\typeTEXfile{../source/unnamed-emoji.tex}

\subsection{unnamed-emoji.opm}
\typeTEXfile{../source/unnamed-emoji.opm}

\subsection{t-unnamed-emoji.mkxl}
\typeTEXfile{../source/t-unnamed-emoji.mkxl}

\subsection{unnamed-emoji.lua}
\typeLUAfile{../source/unnamed-emoji.lua}

\subsection{unemoji-specimens.cld}
\typeLUAfile{../documentation/unemoji-specimens.cld}

\subsection{dvipdfmx.patch}
\typefile{../dvipdfmx.patch}

\stopdocument
