% unnamed-emoji
% https://github.com/gucci-on-fleek/unnamed-emoji
% SPDX-License-Identifier: MPL-2.0+
% SPDX-FileCopyrightText: 2023 Max Chernoff

\wlog{unnamed-emoji v0.0.2} %%version

\catcode`@=11

\ifdefined\directlua
    \input ltluatex
    \pdfextension glyphtounicode{fake!}{0000}
    \directlua{require "unnamed-emoji"}
    \unemoji@load{noto-emoji.pdf}{fake!}
\fi

\ifdefined\pdftexversion
    \def\unemoji@print#1#2{%
        \ifcsname emoji@#2\endcsname%
            \pdfrefximage\csname emoji@#2\endcsname\relax%
        \else%
            \pdfximage named{emoji#2}{#1}%
            \expandafter\chardef\csname emoji@#2\endcsname=\pdflastximage\relax%
            \pdfrefximage\pdflastximage\relax%
        \fi%
    }
\fi

\ifx\unemoji@print\undefined
    \def\unemoji@print#1#2{%
        \hbox to 10pt{%
            \special{pdf:image named "emoji#2" (#1)}%
            \hss%
        }%
    }%
\fi

\def\emojifont{noto-emoji.pdf}

\def\emoji#1{%
    \unemoji@print{\emojifont}{#1}%
}

\catcode`@=12
\endinput
